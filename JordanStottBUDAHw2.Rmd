---
title: "JordanStott Homework2"
author: "Jordan Stott"
date: "2025-09-08"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(alr4)
```

# Question 1
```{r q1 setup}
data(UBSprices)
```

```{r q1a}
plot(UBSprices$bigmac2003,UBSprices$bigmac2009,
     main = "BigMac2009 vs BigMac2003")
```
<br> **Comments:**
<br> As we see in the graph, the data starts to resemble a cone shape. This means the spread of the points gets wider as values further increase.
<br> From lecture, we investigate that this concludes non constant variance, so simple linear regression is not appropriate. 

```{r q1b}
plot(log(UBSprices$bigmac2009)~log(UBSprices$bigmac2003),
     main = "log(BigMac2009) vs log(BigMac2003)")
```
<br> **Comments:**
<br> Taking the log of both variables better ensures a straight line and helps reduce leverage/outlier points.
<br> This is due to being able to inspect percentage increases, making the variance more proportionate but still modeling the same relationship.
<br> As one year goes up, the other does too.

```{r q1c}
mod <- lm(log(bigmac2009)~log(bigmac2003),data=UBSprices)
plot(log(UBSprices$bigmac2009)~log(UBSprices$bigmac2003))
abline(mod,col=2)
summary(mod)
```
<br> **Comments:**
<br> When the Big Mac 2003 price increases by 1%, the 2009 price increases by roughly 0.8% on average.



# Question 2
```{r q2 setup}
data(oldfaith)
interval <- oldfaith$Interval
duration <- oldfaith$Duration
```

```{r q2}
plot(interval ~ duration, data=oldfaith, 
     main= "Old Faithful Geyser Data")
mod2 <- (lm(interval~duration, data=oldfaith))
abline(lm(interval~duration,data=oldfaith))
summary(mod2)
```
<br> **Comments:** 
<br>The graph shows that the longer the current eruption lasts (duration), the longer you will have to wait for the next one to occur. 
<br>For every minute of eruption time, the waiting time until the next eruption goes up by around 0.18 minutes, roughly 10.8 seconds. 

```{r q2b}
nd <- data.frame(duration = 250/60)
predict(mod2,nd,interval="confidence",level=.95)
predict(mod2,nd,interval="prediction",level=.95)
```
<br> **Comments:**
<br> If a customer just witnessed a 250 second eruption and wants to know how long they'll have to wait for the next one, I can tell them:
<br> With 95% confidence, I can say it'll be between 32.4 to 37 minutes.
<br> With a 95% prediction, I can say it'll be between 22.7 to 46.8 minutes. 




# Question 3
```{r q3 setup}
data(UN11)
```

```{r q3}
mod3 <- lm(fertility~log(ppgdp) + pctUrban, data=UN11)
summary(mod3)
avPlots(mod3)
```
<br> **Comments on coefficients:**
<br> For every 1% increase in GDP/person, fertility decreases by 0.6% children per woman on average. 
<br> This shows a negative relationship, with poor countries having more children and wealthier countries having less.
<br> **Comments on added variable plots:**
<br> Comparing the two plots suggests that wealth has much more to do with fertility than urbanization does. 
<br> The P value for the slope regarding urbanization, which is basically 0, suggests the relations are not significant here.
<br> Regarding the P values for each variable, we see wealth is very significant in household size. 




# Question 4
```{r q4 setup}
if (!require("car")) install.packages("car", dependencies = TRUE)
library(car)
data("Transact")
t1 <- Transact$t1
t2 <- Transact$t2
time <- Transact$time
Transact$avg = (t1+t2)/2
Transact$dif = t1-t2
```
**Model 1- t1 and t2**
```{r q4a} 
j1 <- lm(time ~ t1+t2, data=Transact)
summary(j1)
```
**Model 2- average and difference of t1 and t2**
```{r q4b}
j2 <- lm(time ~ avg+dif, data=Transact)
summary(j2)
```
**Model 3- t2 and the average, and then the difference**
```{r q4c}
j3 <- lm(time ~ t2+dif, data=Transact)
summary(j3)
```
**Model 4- t1,t2,average,and difference**
```{r q4d}
j4 <- lm(time ~ t1+t2+avg+dif, data=Transact)
summary(j4)
```
<br> **Comments:**
<br> Models 1-3 are all generally the same because they give the same predictions in different formats. 
<br> All intercepts are the same, and all slopes are all in the same general reach of each other.
<br> Model 4 is problematic and contains NA's because the data it is trying to work with is redundant. 
<br> I would pick model 2 because in my opinion, it tells the results in a much easier way for me to understand and communicate clearly. 
